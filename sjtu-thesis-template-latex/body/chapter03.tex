%%==================================================

\chapter{相关结论和技术}
\label{chap:relat}

为了能更好的研究PRS上的Regularity问题，本章中我们首先将引入一个无限状态系统验证问题中常常用到的重要限定条件，正规化进程，同时我们会对该限定做进一步的规定，并给出完全正规化进程的定义。之后我们将介绍PRS上Regularity问题现阶段我们已知的结论，并进行归纳和总结，并得到一些推论。最后将介绍一些PRS上证明Regularity问题所用到的一些技术和引理。


\section{正规化进程}
\label{sec:norm}
 
在无限状态系统验证问题中，我们常常要对所研究的模型做一些合理的限定，以便使该模型满足一些我们所需要的性质，从而可以得到更好的可判定行或者算法复杂性的结论。从研究语言理论的角度出发，我们经常要求模型是\emph{正规化(Normed)}的。从直观上来说，一个正规化进程可以通过有限步转换到达一个$\epsilon$进程。如果做进一步限定，完全正规化进程则不仅要满足正规化性质，而且到达$\epsilon$进程至少要经过一个可见动作。(完全)正规化进程的定义为：

\begin{defn}[(完全)正规化进程 (Totally)Normed Process]\label{def:norm}
一个进程项$\alpha$的\emph{模(Norm)}，记做$\|\alpha\|$，表示从$\alpha$能达到$\epsilon$的转换序列的最短长度，如果考虑弱互模拟，则不考虑$\tau$动作。

我们称一个进程项$\alpha$是正规化的，如果满足$0\leq\|\alpha\|<\infty$，称它是完全正规化的，如果满足$0<\|\alpha\|<\infty$。
一个正规化的PRS进程$\Delta$中所有的进程变量均是正规化的。
类似的，一个完全正规化的PRS进程$\Delta$中所有的进程变量均是完全正规化的。
\end{defn}

正规化条件规定了一个进程只能做有限个减少模的动作，满足该条件的进程往往会满足一些美妙的分解性质。而完全正规化条件则进一步限定了进程做$\tau$动作的限制，没有进程项能只做$\tau$动作就变空。完全正规化的限定也是十分合理的，在现实系统中通常也不需要定义，或者通过一些技巧来规避那种``悄无声息''就消失的进程。这些限定在研究考虑内部动作的互模拟关系的验证问题时，发挥了很大的作用。

为了表达的简洁性，我们在相关模型前加上n和tn分别作为正规化(Norm)和完全正规化(Totally Normed)的简称。例如Normed BPA简称为nBPA，而Totally Normed PA简称为tnPA。

\section{进程重写系统有限性问题现有结论总结}
\label{sec:prs-reg-result}

本节将根据不同的PRS子模型，分别总结其现有的关于强互模拟，弱互模拟和分支互模拟的Regularity问题的结论，并根据问题的相似性，直接给出一些推论。根据定义\ref{def:prob}中给出的记号，我们将三类问题分别及做$\seq_{REG},\,\weq_{REG}$和$\beq_{REG}$。

表\ref{tab:bpa-reg}为BPA上的结论总结，表中如果出现两行则分别表示该问题已知的复杂度上界和下界。``?''表示该问题还未被解决。

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
		&\BPA 			& \nBPA \\ 
\hline
\hline
$\sim_{REG}$ 	&\begin{tabular}{c} 
		Decidable~\cite{Burkart1995,Burkart1996} \\
		PSPACE-hard~\cite{Srba2002b} 
		\end{tabular} 		
					& NL-complete~\cite{Srba2002b}\cite{Kucera1996} \\ 
\hline
$\beq_{REG}$	&\begin{tabular}{c} ? 
		\\
		EXPTIME-hard~\cite{Mayr2003} 
		\end{tabular} 
					& Decidable~\cite{Fu2013} \\
\hline
$\weq_{REG}$ 	&\begin{tabular}{c} ? 
		\\
		EXPTIME-hard~\cite{Mayr2003} 
		\end{tabular} 
					&\begin{tabular}{c} ? 
					\\ 
					NP-hard~\cite{Srba2003,StriAbra1998} 
					\end{tabular} \\ 
\hline
\end{tabular}
\caption{\textsf{BPA} Regularity 问题现有结论}
\label{tab:bpa-reg}
\end{center}
\end{table}

其中由Fu证明的$nBPA$上$\beq_{REG}$问题的可判定行结论是现在唯一已知的考虑系统内部动作的互模拟等价关系的Regularity问题结论的可判定性结论。这一结论利用到了nBPA中的$\beq$的可判定性证明的相关技术。

表\ref{tab:bpp-reg}总结了BPP上的已知结论：

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|} 
\hline
		&BPP			&nBPP \\ 
\hline
\hline
$\seq_{REG}$		&
		PSPACE-complete~\cite{Kot2005a,Jancar1996,Srba2002a} 
					&\begin{tabular}{c} 
					NL~\cite{Kucera1996} \\ 
					NL-hard~\cite{Srba2002a} 
					\end{tabular} \\ 
\hline
$\beq_{REG}$		& ? 			&? \\ 
\hline
$\weq_{REG}$		&\begin{tabular}{c} 
		? \\ 
		PSPACE-hard~\cite{Srba2003} 
		\end{tabular}		&\begin{tabular}{c} 
					? \\ 
					PSPACE-hard~\cite{Srba2003} 
					\end{tabular} \\ 
\hline
\end{tabular}
\end{center}
\caption{\textsf{BPP} Regularity 问题现有结论}
\label{tab:bpp-reg}
\end{table}

在BPP上，我们已经有了$\seq_{REG}$的PSPACE完全性结论。这里利用到了一种在BPP中常用的DD-Function的技术，来对BPP的等价类进行划分，但是，对$\weq$和$\beq$，DD-Function并不适用，所以我们还需要寻找其他技术来证明其可判定性。

而对与nBPP，在\cite{CzerwiAski2011}，中，给出了$\beq$的可判定性结论，而相关的$\beq_{REG}$问题却一直未被解决。而由于下文中将要提到的引理\ref{lemma:semi-dec}，我们可知该问题至少是半可判定的，所以引起包括本文作者在内的许多研究人员的极大兴趣。但是要完全的解决该问题，还需要客服许多技术上的难题。这一问题还将在本文的第\ref{chap:fut}章中的未解决问题中进一步讨论。

表\ref{tab:pda-reg}为PDA上的现有结论：

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|} 
\hline
		&PDA		&nPDA \\ 
\hline
\hline
$\seq_{REG}$ 		&\begin{tabular}{c} 
		? \\ 
		EXPTIME-hard~\cite{Kucera2002a,Srba2002b} 
		\end{tabular} 	& \begin{tabular}{c} 
				P~\cite{Esparza2000} \\ 
				NL-hard~\cite{Srba2002b} 
				\end{tabular} \\ 
\hline
$\beq_{REG}$		& ? 		& ? \\ 
\hline
$\weq_{REG}$ 		&\begin{tabular}{c} 
		? \\ 
		EXPTIME-hard~\cite{Kucera2002a,Srba2002b}
		\end{tabular} 	& \begin{tabular}{c} 
				? \\ 
				EXPTIME-hard~\cite{Kucera2002a,Srba2002b} \end{tabular} \\ 
\hline
\end{tabular}
\end{center}
\caption{\textsf{PDA} Regularity 问题现有结论}
\label{tab:pda-reg}
\end{table}

在PDA上，我们似乎还没有找到一些好的方法来处理Regularity问题，即使对$\seq_{REG}$。我们只是关于nPDA的$\seq_{REG}$问题，有多项式时间的算法。

表\ref{tab:pn-reg}总结了PN上的现有结论：

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|} 
\hline
		&PN			&nPN \\ 
\hline
\hline
$\seq_{REG}$ 		&\begin{tabular}{c} 
		Decidable~\cite{Jancar1996} \\ 
		PSPACE-hard~\cite{Srba2002a} 
		\end{tabular}		&\begin{tabular}{c} 
					EXPSAPCE~\cite{Rackoff1978} \\ 
					EXPSPACE-hard~\cite{Cardoza1976} 
					\end{tabular} \\ 
\hline
$\beq_{REG}$ 		&Undecidable*	&? \\ 
\hline
$\weq_{REG}$ 		&\begin{tabular}{c} 
		Undecidable~\cite{Jancar1996} \\ 
		EXPSPACE-hard~\cite{Cardoza1976} 
		\end{tabular} 		&\begin{tabular}{c} 
					? \\ 
					EXPSPACE-hard~\cite{Cardoza1976} 
					\end{tabular} \\ 
\hline
\end{tabular}
\end{center}
\caption{\textsf{PN} Regularity 问题现有结论}
\label{tab:pn-reg}
\end{table}

PN这类并行进程的研究中经常会用到Presburg算数来刻画其中的一些问题，从而能得到一些直接的判定性结论。同时，对于PN中的进程，我们有一个等价的向量表示，称为Vector Addition System(VAS)，其中的很多技术可以用于PN中相关问题的证明，如可达性问题(Reachability)。同时这种向量表示在相关验证的问题的表述中也会带来很大的方便性。

这里我们注意表\ref{tab:pn-reg}中＊所标的结论，即PN上$\beq_{REG}$的不可判定性并未直接在引用论文中出现，而是本文作者经过与合作者的严格论证，将$\weq_{REG}$不可判定性的证明技术，应用到$\beq_{REG}$上，得出的一个引文\cite{Jancar1996}的推论。

\begin{cor}[PN $\beq_{REG}$ 的不可判定性]\label{cor:pn-beq-und}
PN的$\beq_{REG}$问题是不可判定(Undecidable)的。
\end{cor}

另外我们注意到，BPP实际是一种特殊的Petri网，在\ref{Esparza1997}中定义了这种PN的子类，称为Communication Free Petri网，它其实就是一种进程间通信的并发模型。利用这一等价模型，我们可以利用PN中的技术和结论，通过条件的加强，来证明BPP上相关问题的结论。

最后表\ref{tab:pa-reg}将总结PA上的相关结论，因为我们将要研究的问题是tnPA上的，所以这里同时还总结了tnPA上的结论。

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
	&PA	&nPA	&tnPA\\
\hline
\hline
\multirow{2}{*}{$\seq_{REG}$} &
 ? &NL~\cite{Kucera1996} &NL~\cite{Kucera1996} \\
& PSPACE-hard~\cite{Srba2002a} & NL-hard~\cite{Srba2002a} & NL-hard~\cite{Srba2002a}\\
\hline
\multirow{2}{*}{$\beq_{REG}$} &
 ? & ? &P* \\
& EXIPTIME-hard~\cite{Mayr2003} & PSPACE-hard~\cite{Srba2003} & NL-hard~\cite{Srba2002a}\\
\hline
\multirow{2}{*}{$\weq_{REG}$} &
 ? & ? &P* \\
& EXPTIME-hard~\cite{Mayr2003} & PSPACE-hard~\cite{Srba2003} & NL-hard~\cite{Srba2002a}\\
\hline
\end{tabular}
\caption{\textsf{PA} Regularity 问题现有结论}
\label{tab:pa-reg}
\end{center}
\end{table}
PA模型的进程项中由于同时允许串行和并行连结符的存在，所以为判定性带来了很大的难度。很大程度上我们现阶段的证明只能在nPA的限制下，通过一些巧妙的技术来规避这些连结符的复杂性带来的困扰。

表\ref{tab:pa-reg}中＊所标的两个多项式时间判定算法为本文的主要结论，该结论同样适用于PA的子模型tnBPA和tnBPP。同时该问题的时间复杂度也将在本文中给出。

\section{相关技术路线和引理}
\label{sec:lemma}

本节中，我们将对PRS下Regularity问题证明的技术路线进行讨论，并给出一些与具体模型无关的，关于Regularity问题的一般性引理。

我们通常用$(\alpha,\Delta)$来表示初始状态为$\alpha$，转换规则集合为$\Delta$的某个PRS进程。

Regularity问题是在一个可以表示无限状态的系统中，探究它的有限状态的性质。从进程进行转换的角度出发，我们可以给出一个进程不满足Regularity性质的等价条件。

从进程行为的角度出发，为了寻找进程中状态的无限性，我们需要寻找一个如引理\ref{lemma:infi-path}中的进程无限长的动作序列。

\begin{lem}[Infinite $\not\cong$ Path]\label{lemma:infi-path}
一个进程系统$(\alpha,\Delta)$，关于等价关系$\cong$不是Regular的，\emph{当且仅当}存在一个无限长的动作序列
$$\alpha\act{a_0}\alpha_1\act{a_1}\alpha_2\act{a_2}\ldots$$ 
满足对任意$i\neq j$，有$\alpha_i\not\cong\alpha_j$。
\end{lem}

\begin{proof}
我们分别证明充分性和必要性：
\begin{itemize}
	\item $\Rightarrow$ 假设$(\alpha,\Delta)$不是$\cong_{REG}$的，那么我们将所有从$\alpha$出发的动作序列看成一棵以$\alpha$为根的树(Tree)。由于所有转换规则构成一个有限集合，所以这个图也是有限分枝的(Finite Branching)。由假设，$(\alpha,\Delta)$不是$\cong_{REG}$的，所以这颗树上有无限个互补关于$\cong$等价的不同的状态。那么，就一定存在一条满足条件的无限长的序列。否则，这样的路径就会变成一个环，由于该树只有有限分枝，就不存在无限的关于$\cong$互不相同的状态了。这样就证明了该序列一定存在。
	\item $\Leftarrow$ 存在这样的无限长动作序列，则$(\alpha,\Delta)$满足Regularity的定义。
\end{itemize}
\end{proof}

相对于特定的互模拟等价$\cong$的判定，一个更容易的任务是判定两个进程项在表示上是否完全相同(Lexically Equivalent)。即两个进程是否是完全相同的表达式。我们用$\equiv$来表示。我们下面给出一个$\not\cong_{REG}$的必要条件。

\begin{lem}[Infinite $\not\equiv$ Path]\label{lemma:infi-path-2}
一个进程系统$(\alpha,\Delta)$，关于等价关系$\cong$不是Regular的，\emph{那么}存在一个无限长的动作序列
$$\alpha\act{a_0}\alpha_1\act{a_1}\alpha_2\act{a_2}\ldots$$ 
满足对任意$i\neq j$，有$\alpha_i\not\equiv\alpha_j$。
\end{lem}

\begin{proof}
和引理\ref{lemma:infi-path}证明类似，与之同理，我们考虑以$\alpha$为根的一棵转换动作的树。如引理\ref{lemma:infi-path}中的无限长路径一定存在，而$\not\cong$则一定有$\not\equiv$。证毕。
\end{proof}

关于正规化进程，我们显然有模不相等的进程是不互模拟等价的。这样我们就有了一个关于正规化进程的Regularity问题的充分条件。

\begin{lem}[Infinite Norm Increasing Path]\label{lemma:infi-path-3}
一个进程系统$(\alpha,\Delta)$，\emph{如果}存在一个无限长的动作序列
$$\alpha\act{a_0}\alpha_1\act{a_1}\alpha_2\act{a_2}\ldots$$ 
满足对任意$i$，存在$j$，有$\|\alpha_i\|<\|\alpha_j\|$。
那么该进程系统不是Regular的。
\end{lem}

\begin{proof}
如果存在这样的动作序列，那么$(\alpha,\Delta)$显然满足不是Regular的定义。
\end{proof}

另一个重要的引理是，如果一个进程系统$(\alpha,\Delta)$的某个等价关系$\cong$或$\cong_{FS}$是\emph{可判定的(Decidable)}，那么相应的$\cong_{REG}$是\emph{半可判定(Semi-Decidable)}的。这是一个对于Regularity问题十分重要的结论，因为这样在很多情况下，我们就只需要再去证明另一半问题$\not\cong_{REG}$的半可判定性了。

\begin{lem}[Semi-Decidability]\label{lemma:semi-dec}
若$(\alpha,\Delta)$的$\cong$或者$\cong_{FS}$是可判定的(Decidable)，那么$\cong_{REG}$是半可判定的(Semi-Decidable)。
\end{lem}

\begin{proof}
考虑以下过程，我们通过对有限状态系统FS的某种编码，可以有效地枚举(Enumerate)其中的进程$(\gamma,\Delta')$。接着我们利用$\cong$或者$\cong_{FS}$的相应算法判定其是否与$(\alpha,\Delta)$等价。如果等价，则该过程终止，该进程系统满足Regularity性质，否则继续重复枚举过程。该过程即是一个$\cong_{REG}$的半可判定算法。
\end{proof}

而对于另一半问题$\not\cong_{REG}$的研究，由于我们不可能直接去验证路径的无限长度这样的性质，所以我们只能去寻找一些进程生成的状态树中的一些有限的子结构。例如一些可能通过重复作用而生成出无限状态的动作串。这类子结构在各种不同的模型中会满足不同的性质，常常会在Regularity的判定算法中起到关键作用。对于tnPA，本文将在第\ref{chap:tnpa-equiv}章中具体研究这种子结构。
